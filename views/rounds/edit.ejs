<% include ../partials/header %>
    <div class="container">
        <div class="row form-inline input_row">
            <div class="form-group" id="course_image">
            </div>
            <div class="form-group">
               <label for="course_dropdown">Course:</label>
               <select class="form-control" id="course_dropdown">
                    <option value=""></option>
                    <% courses.forEach(function(course){ %>
                      <option id=<% course.name %> value=<% course.name %>><%= course.name %></option>
                    <% }); %>
                </select>
            </div>
            <div class="form-group">
                <label for="holes_dropdown"># of Holes:</label>
                <select class="form-control" id="holes_dropdown" disabled>
                    <option id="default_num_holes" value="">Select Course</option>
                </select>
            </div>
            <div class="form-group">
                <label for="tees_dropdown">Tees:</label>
                <select class="form-control" id="tees_dropdown">
                    <% course[0].tees.forEach(function(tee) { %>
                        <option value=<%=tee%>><%=tee%></option>
                 <% }); %>
                </select>
            </div>
            <div class="form-group">
                <div class='input-group date' id='datetimepicker1'>
                    <label for="round_date">Round Date & Time:</label>
                    <input type='text' class="form-control" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
            </div>
            <div class="form-group">
                <form class="delete-form" action="/rounds/<%= round._id %>?_method=DELETE" method="POST">
                    <button class="btn btn-m btn-danger"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                </form>
            </div>
        </div> 
    </div>  
    <hr>
    <div class="container-fluid">
        <% for(var i = 1; i <= 18; i++) { %>
            <form id='form_hole_<%=i%>' action="/rounds" method="POST">
                <div class="row form-inline input_row">
                    <fieldset>
                        <div class="form-group input_card">
                            <div id="hole_<%=i%>" class="form-group hole_desc">
                        </div>
                        <div class="form-group fg_input">
                            <label for="tsc" class="Label_input">Tee Club</label>
                            <select name="round[tsc]" class="form-control f_input" id="tsc_<%=i%>">
                                <option value=""></option>
                                  <option value="Driver">Driver</option>
                                  <option value="3W">3W</option>
                                  <option value="5W">5W</option>
                                  <option value="Rescue">Rescue</option></option>
                                  <option value="3I">3I</option>
                                  <option value="4I">4I</option>
                                  <option value="5I">5I</option>
                                  <option value="6I">6I</option>
                                  <option value="7I">7I</option>
                                  <option value="8I">8I</option>
                                  <option value="9I">9I</option>
                                  <option value="PW">PW</option>
                                  <option value="GW">GW</option>
                                  <option value="SW">SW</option>
                                  <option value="LW">LW</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="tsl" class="Label_input">Tee Length</label>
                            <input type="number" name="round[tsl]" class="form-control f_input tsl" id="tsl_<%=i%>" min="0">
                        </div>
                        <div class="form-group fg_input">
                            <label for="tsd" class="Label_input">Tee Direction</label>
                            <select name="round[tsd]" class="form-control f_input tsd" id="tsd_<%=i%>">
                                <option value=""></option>
                                  <option value="Fairway">Fairway</option>
                                  <option value="Left">Left</option>
                                  <option value="Right">Right</option>
                                  <option value="Short">Short</option></option>
                                  <option value="Long">Long</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="tsr" class="Label_input">Tee Result</label>
                            <select name="round[tsr]" class="form-control f_input" id="tsr_<%=i%>">
                                <option value=""></option>
                                  <option value="FIR">FIR</option>
                                  <option value="Rough">Rough</option>
                                  <option value="Bunker">Bunker</option>
                                  <option value="Woods">Woods</option></option>
                                  <option value="Fescue">Fescue</option>
                                  <option value="Water">Water</option>
                                  <option value="Lost Ball">Lost Ball</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="atg" class="Label_input">Appr. to Green</label>
                            <select name="round[atg]" class="form-control f_input atg" id="atg_<%=i%>">
                                <option value=""></option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="ac" class="Label_input">Appr. Club</label>
                            <select name="round[ac]" class="form-control f_input" id="ac_<%=i%>">
                                <option value=""></option>
                                  <option value="Driver">Driver</option>
                                  <option value="3W">3W</option>
                                  <option value="5W">5W</option>
                                  <option value="Rescue">Rescue</option></option>
                                  <option value="3I">3I</option>
                                  <option value="4I">4I</option>
                                  <option value="5I">5I</option>
                                  <option value="6I">6I</option>
                                  <option value="7I">7I</option>
                                  <option value="8I">8I</option>
                                  <option value="9I">9I</option>
                                  <option value="PW">PW</option>
                                  <option value="GW">GW</option>
                                  <option value="SW">SW</option>
                                  <option value="LW">LW</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="al" class="Label_input">Appr. Length</label>
                            <input type="number" name="round[al]" class="form-control f_input al" id="al_<%=i%>" min="0">
                        </div>
                        <div class="form-group fg_input">
                            <label for="ad" class="Label_input">Appr. Direction</label>
                            <select name="round[ad]" class="form-control f_input ad" id="ad_<%=i%>">
                                <option value=""></option>
                                  <option value="Green">Green</option>
                                  <option value="Left">Left</option>
                                  <option value="Right">Right</option>
                                  <option value="Short">Short</option></option>
                                  <option value="Long">Long</option>
                            </select>
                        </div>
                        <div class="form-group fg_input">
                            <label for="ar" class="Label_input">Appr. Result</label>
                            <select name="round[ar]" class="form-control f_input" id="ar_<%=i%>">
                                <option value=""></option>
                                  <option value="GIR">GIR</option>
                                  <option value="Fringe">Fringe</option>
                                  <option value="Rough">Rough</option>
                                  <option value="Bunker">Bunker</option>
                                  <option value="Woods">Woods</option></option>
                                  <option value="Fescue">Fescue</option>
                                  <option value="Water">Water</option>
                                  <option value="Lost Ball">Lost Ball</option>
                            </select>
                        </div>
                        <div class="form-group fg_input xs_input">
                            <label for="putts" class="Label_input">Putts</label>
                            <input type="number" name="round[putts]" class="form-control f_input putts xs_input" id="putts_<%=i%>" min="0">
                        </div>
                        <div id="hole_<%=i%>_score" class="form-group fg_input xs_input">
                            <label for="score" class="Label_input">Score</label>
                            <input type="number" name="round[score]" class="form-control f_input xs_input" id="score_<%=i%>" min="1">
                        </div>
                        <div class="form-group hole_submit">
                            <button type="submit" id="submit_<%=i%>" class="btn btn-xs btn-success save_btn">Save</button>
                            <button type="submit" id="edit_<%=i%>" class="btn btn-xs btn-warning edit_btn">Edit</button>
                            <button type="submit" id="clear_<%=i%>" class="btn btn-xs btn-danger clear_btn">Clear</button>
                        </div>
                        <input name="round[course]" type="hidden" value="<%= round.courseName %>" id="hidden_course_<%=i%>" class="hidden_course">
                        <input name="round[numHoles]" type="hidden" value="<%= round.roundType %>" id="hidden_num_holes_<%=i%>" class="hidden_num_holes">
                        <input name="round[datetime]" type="hidden" value="<%= round.date %>" id="hidden_datetime_<%=i%>" class="hidden_datetime">
                        <input name="round[par]" type="hidden" value="" id="hidden_par_<%=i%>">
                        <input name="round[holeNumber]" type="hidden" value="<%=i%>" id="hidden_hole_number_<%=i%>">
                        <input name="round[tees]" type="hidden" value="<%= round.tees %>" id="hidden_tees_<%=i%>">
                        <input name="round[edit]" type="hidden" value="edit" id="hidden_edit_<%=i%>">
                    </fieldset>
                </div>
            </form>
            <hr id="hr_<%=i%>">
        <% } %>
    </div>
<script src="../../scripts/rounds/new.js"></script>   
<script>

    //Set Dropdowns
    var courseName = $('#hidden_course_1').val(),
        numHoles = $('#hidden_num_holes_1').val(),
        tees = $('#hidden_tees_1').val(),
        date = new Date($('#hidden_datetime_1').val()),
        formattedDate = formatDate(date);
    
    setOption(document.getElementById('course_dropdown'), courseName);
    $("#course_dropdown").trigger("change");
    setOption(document.getElementById('tees_dropdown'), tees);
    $("#tees_dropdown").trigger("change");
    $('#datetimepicker1').find("input").val(formattedDate);
    
    //Disable Round Key Inputs
    $('#course_dropdown').prop("disabled", true);
    $('#tees_dropdown').prop("disabled", true);
    $('#datetimepicker1  > .form-control').prop("disabled", true);
    
    function formatDate(date) {
        var hours = date.getHours();
        var minutes = date.getMinutes();
        var ampm = hours >= 12 ? 'pm' : 'am';
        hours = hours % 12;
        hours = hours ? hours : 12; // the hour '0' should be '12'
        minutes = minutes < 10 ? '0'+minutes : minutes;
        var strTime = hours + ':' + minutes + ' ' + ampm;
        return date.getMonth()+1 + "/" + date.getDate() + "/" + date.getFullYear() + "  " + strTime;
    }
    
    function setOption(selectElement, value) {
        var options = selectElement.options;
        for (var i = 0; i < options.length; i++)  {
            if (options[i].value == value) {
                selectElement.selectedIndex = i;
                return true;
            }
        }
        return false;
    }
    
    function toggleInputs(hole_submitted, bool){
        $('#fir_' + hole_submitted).prop("disabled", bool);
        $('#gir_' + hole_submitted).prop("disabled", bool);
        $("input#score_" + hole_submitted).prop("disabled", bool);
        $("input#putts_" + hole_submitted).prop("disabled", bool);
        $("#tsc_" + hole_submitted).prop("disabled", bool);
        $("#tsl_" + hole_submitted).prop("disabled", bool);
        $("#tsd_" + hole_submitted).prop("disabled", bool);
        $("#tsr_" + hole_submitted).prop("disabled", bool);
        $("#atg_" + hole_submitted).prop("disabled", bool);
        $("#ac_" + hole_submitted).prop("disabled", bool);
        $("#al_" + hole_submitted).prop("disabled", bool);
        $("#ad_" + hole_submitted).prop("disabled", bool);
        $("#ar_" + hole_submitted).prop("disabled", bool);
        $('#submit_' + hole_submitted).prop("disabled", bool);
        
        if(bool){
            $('#submit_' + hole_submitted).html('Saved');
        } else {
            $('#submit_' + hole_submitted).html('Save');
        }
    }
</script>
<% include ../partials/footer %>